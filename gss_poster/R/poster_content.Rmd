---
title: "GSS Poster Presentation"
author: "Kathleen E. Wendt, Siqi Zhang, & Mallory J. Feldman"
date: "Draft by 11/04/2019"
output: pdf_document
---

```{r global_options, include = FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig.path='figs/',
                      warning=FALSE, message=FALSE)
```

# Introduction - @iqis - can condense introductory sections into poster space by taking key concepts and key words 

## The Problem

- Contemporary perspectives on the embodied mind have increased interest in psychophysiological processes and their measurement.
- While there has been significant theoretical and technological innovation within this domain, the field still lacks sophisticated tools for managing the quantity and quality of data collected with physiological measurements.
- We begin to address this need, by introducing a novel pipeline for wrangling, visualizing, and analyzing certain types of physiological data.
- R has robust existing infrastructure for open source software development (see Advanced R and R Packages books).
- This pipeline is implemented in R and capitalizes on larger discourses surrounding open science practices, computational reproducibility, and open source software development.

- Collecting and cleaning physiological data requires multiple software which are versioned and expensive.
- Using these software, the typical psychophysiology study produces several output files per-subject **[SEE DIAGRAM]
- These output files vary in their formatting and require extensive data wrangling (e.g., cleaning, exclusions, compilation, alignment) **[NOT SURE THESE EXAMPLES ARE BEST] 
- When conducted via copy-and-paste (e.g., Excel and SPSS) these processes introduce several researchers' degrees of freedom and opportunities for error 
- **Error-ridden data produces error-driven inferences** [main point!]
- Because there is no standardized pipeline for data wrangling, analysis, and visualization, data is difficult to share (both internally and externally) and results are difficult to reproduce.

## Rise of computational reproducibility (see lit folder for references)

- R ecosystem
- Rise of data science, open science, and open source software development (e.g., Unconferences to promote open source software development and interdisciplinary collaboration)
- Tidyverse principles (see lit folder for Wickham papers)

## The Solution 

- Our answer: `psyphr` - R package suite (currently supporting recent versions of MindWare Technologies workbooks)
- This poster to illustrate purpose and functionality of first R package in suite: `psyphr.read` : wrangle and tidy psychophysiological data from proprietary data collection systems

# Load Packages

```{r packages}
# devtools::install_github("psyphr-dev/psyphr.read")
library(psyphr.read)
library(tidyverse)
library(readxl)
```

# Example data

Would it be better to take snapshots of the file directory structure and even the Excel workbook? I am trying to think about the best way to show that these data are disorganized, messy, and in need of `psyphr` tools. I don't think it would be particularly useful to include all the code required to "wrangle" one Excel workbook.

```{r xlsx_preview}
readxl::read_xlsx("../data/Pilot1/Pilot_Sub1_ECG_Baseline.xlsx", sheet = 1) %>%
  tibble::glimpse()
```

## Create lists of file names - @iqis, what do you think is the best way to manage the multiple person/task/stream problem? I don't think `psyphr.read::MW()` is best used on a folder split by person and task. It would be best for the user to be able to map all of the files in a study at once and have internal labels for person, task, and data stream type that can be filtered.

```{r file_list1}
pilot1_files <- list.files("../data/Pilot1",
                           pattern = ".xlsx",
                           full.names = TRUE)
pilot1_files
```

```{r file_list2}
pilot2_files <- list.files("../data/Pilot2",
                           pattern = ".xlsx",
                           full.names = TRUE)
pilot2_files
```

## Use `psyphr.read::MW()` to read data 

`psyphr.read` can wrangle and tidy the Heart Rate Variability and Electrodermal Activity output (Excel workbooks per person per data stream per research task) from MindWare Technologies.

```{r read_file1}
pilot1_list <- purrr::map(pilot1_files, psyphr.read::MW)
```

```{r read_file2}
pilot2_list <- purrr::map(pilot2_files, psyphr.read::MW)
```

## Transform -- @iqis, what step am I missing? I was playing around with `purrr::map_depth` and `purrr::flatten()` but couldn't get the levels right. 

```{r}
# broken - psyphr.read::unnest_data(pilot1_list)
```

## Visualize 

Once I learn how to properly use `psyphr.read`, we can move on to plotting example data. I think we should have two time series plots. One for Respiratory Sinus Arrhythmia (under HRV Stats) and one for Tonic Skin Conductance Level (under EDA Stats). If we are ambitious, we can include data from both baseline and RLS task.


